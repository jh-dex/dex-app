<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<title>ë§›ì§‘ê¸°ë¡ â€” ë‚˜ë§Œì˜ ë§›ì§‘ ë¦¬ë·° ì„œë¹„ìŠ¤</title>
<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"/>
<link rel="icon" href="./public/favicon.ico" />
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DARK THEME  â€” MD ìŠ¤í™ ê¸°ì¤€
   primary:#00FF4D  accent:#00FF4D
   bg:#000  card:#0A0A0A  popover:#0F0F0F
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[data-theme="dark"]{
  --brand:#00FF4D;--brand-light:#33FF85;--brand-dark:#2FE861;
  --brand-bg:rgba(0,255,77,.08);
  --bg:#000;--surface:#0A0A0A;--popover:#0F0F0F;
  --neutral-50:#111;--neutral-100:#1A1A1A;--neutral-200:#1F1F1F;
  --neutral-300:#2A2A2A;--neutral-400:#888;--neutral-500:#999;
  --neutral-600:#AAA;--neutral-700:#CCC;--neutral-800:#E0E0E0;--neutral-900:#FFF;
  --header-bg:rgba(0,0,0,.85);
  --shadow-sm:0 1px 2px rgba(0,0,0,.4),0 0 0 1px rgba(255,255,255,.03);
  --shadow-md:0 4px 16px rgba(0,0,0,.5),0 0 0 1px rgba(255,255,255,.04);
  --shadow-lg:0 12px 40px rgba(0,0,0,.6),0 0 0 1px rgba(255,255,255,.05);
  --shadow-hover:0 8px 30px rgba(0,255,77,.12),0 0 0 1px rgba(0,255,77,.15);
  --btn-fg:#000;
  --badge-bg:rgba(0,255,77,.1);--badge-color:#00FF4D;
  --empty-grad:linear-gradient(180deg,#0A0A0A,#0F0F0F);
  --score-low:#AAA;
  --av-bg:18%;--av-fg:65%;
  --del-c:#FF3B30;--del-bc:#3A1515;--del-bg:rgba(255,59,48,.08);
  --accent-grad:linear-gradient(135deg,var(--brand-bg),rgba(0,255,77,.04));
  --pick-bc:rgba(0,255,77,.2);
  --focus:rgba(0,255,77,.15);--glow:rgba(0,255,77,.3);
  --ring:#00FF4D
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LIGHT THEME  â€” ê·¸ë¦° ê³„ì—´ ë¼ì´íŠ¸ ë³€í™˜
   primary ëª…ë„ë¥¼ ë‚®ì¶° ê°€ë…ì„± í™•ë³´
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[data-theme="light"]{
  --brand:#00B341;--brand-light:#33D46A;--brand-dark:#009636;
  --brand-bg:rgba(0,179,65,.06);
  --bg:#FFFFFF;--surface:#FFFFFF;--popover:#FFFFFF;
  --neutral-50:#F5F7F5;--neutral-100:#EAEDEB;--neutral-200:#D4DAD6;
  --neutral-300:#BBC4BD;--neutral-400:#8A9A8E;--neutral-500:#6B7B6F;
  --neutral-600:#4D5C50;--neutral-700:#3A4A3D;--neutral-800:#252E27;--neutral-900:#111714;
  --header-bg:rgba(255,255,255,.88);
  --shadow-sm:0 1px 3px rgba(0,40,10,.05),0 1px 2px rgba(0,40,10,.03);
  --shadow-md:0 4px 16px rgba(0,40,10,.07),0 2px 4px rgba(0,40,10,.04);
  --shadow-lg:0 12px 40px rgba(0,40,10,.09),0 4px 12px rgba(0,40,10,.05);
  --shadow-hover:0 8px 30px rgba(0,179,65,.12),0 4px 8px rgba(0,40,10,.06);
  --btn-fg:#FFF;
  --badge-bg:rgba(0,179,65,.1);--badge-color:#009636;
  --empty-grad:linear-gradient(180deg,#FFFFFF,#F5F7F5);
  --score-low:#6B7B6F;
  --av-bg:88%;--av-fg:35%;
  --del-c:#D32F2F;--del-bc:#F0C7C7;--del-bg:#FFF6F6;
  --accent-grad:linear-gradient(135deg,var(--brand-bg),rgba(0,179,65,.04));
  --pick-bc:rgba(0,179,65,.25);
  --focus:rgba(0,179,65,.12);--glow:rgba(0,179,65,.25);
  --ring:#00B341
}

:root{--radius-sm:8px;--radius-md:14px;--radius-lg:20px;--radius-xl:28px;--space-xs:4px;--space-sm:8px;--space-md:16px;--space-lg:24px;--space-xl:40px;--space-2xl:64px}
*{box-sizing:border-box;margin:0;padding:0}
html{overflow-x:hidden}
body{overflow-x:hidden;overflow-y:scroll}
body{font-family:'Pretendard',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background:var(--bg);min-height:100vh;color:var(--neutral-800);transition:background .3s,color .3s}
#root{min-height:100vh}
.page-enter{opacity:1;transform:translateY(0);transition:all .35s cubic-bezier(.22,1,.36,1)}.page-exit{opacity:0;transform:translateY(12px)}
.card-item{transition:all .3s cubic-bezier(.22,1,.36,1);cursor:pointer}.card-item:hover{transform:translateY(-4px);box-shadow:var(--shadow-hover)}
.btn-primary{background:var(--brand);color:var(--btn-fg);border:none;padding:14px 32px;border-radius:var(--radius-md);font-family:inherit;font-weight:600;font-size:15px;cursor:pointer;transition:all .2s;letter-spacing:-.02em}
.btn-primary:hover{background:var(--brand-dark);transform:translateY(-1px);box-shadow:0 4px 12px var(--glow)}
.btn-primary:disabled{background:var(--neutral-300);color:var(--neutral-400);cursor:not-allowed;transform:none;box-shadow:none}
.btn-secondary{background:transparent;color:var(--neutral-600);border:1.5px solid var(--neutral-200);padding:12px 28px;border-radius:var(--radius-md);font-family:inherit;font-weight:500;font-size:15px;cursor:pointer;transition:all .2s;letter-spacing:-.02em}
.btn-secondary:hover{border-color:var(--brand);color:var(--brand);background:var(--brand-bg)}
.input-field{width:100%;padding:14px 18px;border:1.5px solid var(--neutral-200);border-radius:var(--radius-md);font-family:inherit;font-size:16px;color:var(--neutral-800);background:var(--popover);transition:all .2s;outline:none;letter-spacing:-.02em}
.input-field::placeholder{color:var(--neutral-400)}.input-field:focus{border-color:var(--ring);box-shadow:0 0 0 3px var(--focus)}
.stagger-item{opacity:0;transform:translateY(16px);animation:fadeUp .5s cubic-bezier(.22,1,.36,1) forwards}
@keyframes fadeUp{to{opacity:1;transform:translateY(0)}}@keyframes slideDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{to{transform:rotate(360deg)}}
.review-item{animation:slideDown .3s ease forwards}
.search-item{padding:16px 20px;cursor:pointer;transition:all .15s;border-bottom:1px solid var(--neutral-100)}.search-item:hover{background:var(--brand-bg)}.search-item:last-child{border-bottom:none}
.tag{display:inline-flex;align-items:center;gap:4px;padding:5px 12px;border-radius:100px;font-size:12px;font-weight:600;letter-spacing:-.02em}
.theme-btn{width:36px;height:36px;border-radius:50%;border:1.5px solid var(--neutral-200);background:var(--surface);cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--neutral-500);transition:all .2s;padding:0;flex-shrink:0}.theme-btn:hover{border-color:var(--brand);color:var(--brand);background:var(--brand-bg)}

main.container-main{padding-bottom:96px!important}
@media(max-width:640px){.responsive-grid{grid-template-columns:1fr!important}.hero-title{font-size:28px!important}.container-main{padding-left:16px!important;padding-right:16px!important}main.container-main{padding-bottom:16px!important}}
</style>
</head>
<body>
<div id="root"></div>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel">
const {useState, useEffect, useRef, useMemo, useCallback} = React;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIG â€” ì—¬ê¸°ì— í‚¤ë¥¼ ë„£ìœ¼ì„¸ìš”
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SUPABASE_URL="https://wxlqnlkxxddoszcoypbn.supabase.co";
const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind4bHFubGt4eGRkb3N6Y295cGJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA5NzkwNTksImV4cCI6MjA4NjU1NTA1OX0.Dmad5ZyA0wqtWAMg7q--KzW8i8_WBQMDT2364oPFOic";
const KAKAO_JS_KEY="f9808cf4bbd88596818153811b814a67";
const USE_KAKAO=!!KAKAO_JS_KEY;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Supabase ê°„ì´ í´ë¼ì´ì–¸íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const supabase = {
  headers: {
    "apikey": SUPABASE_ANON_KEY,
    "Authorization": `Bearer ${SUPABASE_ANON_KEY}`,
    "Content-Type": "application/json",
    "Prefer": "return=representation"
  },

  async get(table, params = "") {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}?${params}`, {
      headers: this.headers
    });
    return response.json();
  },

  async post(table, body) {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {
      method: "POST",
      headers: this.headers,
      body: JSON.stringify(body)
    });
    return response.json();
  },

  async delete(table, params = "") {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}?${params}`, {
      method: "DELETE",
      headers: this.headers
    });
    return response.json();
  }
};

// DBì—ì„œ ëª¨ë“  ë§›ì§‘ê³¼ ë¦¬ë·° ë¡œë“œ
async function loadFromDB() {
  const restaurants = await supabase.get("restaurants", "order=created_at.desc");
  const reviews = await supabase.get("reviews", "order=created_at.desc");

  return restaurants.map(restaurant => ({
    id: restaurant.id,
    name: restaurant.name,
    address: restaurant.address,
    category: restaurant.category,
    phone: restaurant.phone,
    mapLink: restaurant.map_link,
    reviews: reviews
      .filter(review => review.restaurant_id === restaurant.id)
      .map(review => ({
        id: review.id,
        nickname: review.nickname,
        rating: review.rating,
        comment: review.comment,
        createdAt: review.created_at.slice(0, 10)
      }))
  }));
}

// ë§›ì§‘ DBì— ì¶”ê°€
async function addRestaurantToDB(data) {
  const result = await supabase.post("restaurants", {
    name: data.name,
    address: data.address,
    category: data.category,
    phone: data.phone,
    map_link: data.mapLink
  });
  return result[0];
}

// ë¦¬ë·° DBì— ì¶”ê°€
async function addReviewToDB(restaurantId, data) {
  const result = await supabase.post("reviews", {
    restaurant_id: restaurantId,
    nickname: data.nickname,
    rating: data.rating,
    comment: data.comment
  });
  return result[0];
}

// ë¦¬ë·° DBì—ì„œ ì‚­ì œ
async function deleteReviewFromDB(id) {
  await supabase.delete("reviews", `id=eq.${id}`);
}

// ë§›ì§‘ê³¼ ê´€ë ¨ ë¦¬ë·° DBì—ì„œ ì‚­ì œ
async function deleteRestaurantFromDB(id) {
  await supabase.delete("reviews", `restaurant_id=eq.${id}`);
  await supabase.delete("restaurants", `id=eq.${id}`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ì¹´ì¹´ì˜¤ JS SDK í‚¤ì›Œë“œ ê²€ìƒ‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const kakaoSearch = (query) => {
  return new Promise((resolve) => {
    // ì¹´ì¹´ì˜¤ë§µ APIê°€ ë¡œë“œë˜ì§€ ì•Šì€ ê²½ìš°
    if (!window.kakao?.maps?.services) {
      resolve([]);
      return;
    }

    const places = new window.kakao.maps.services.Places();

    places.keywordSearch(
      query,
      (data, status) => {
        if (status === window.kakao.maps.services.Status.OK) {
          // ìŒì‹ì  ì¹´í…Œê³ ë¦¬ë§Œ í•„í„°ë§
          const foodPlaces = data.filter(
            place => place.category_group_code === "FD6" ||
                    place.category_name?.includes("ìŒì‹ì ")
          );
          // ìŒì‹ì ì´ ìˆìœ¼ë©´ ìŒì‹ì ë§Œ, ì—†ìœ¼ë©´ ì „ì²´ ê²°ê³¼ ë°˜í™˜
          resolve(foodPlaces.length > 0 ? foodPlaces.slice(0, 8) : data.slice(0, 8));
        } else {
          resolve([]);
        }
      },
      {
        category_group_code: "FD6", // ìŒì‹ì  ì¹´í…Œê³ ë¦¬ ì½”ë“œ
        size: 10
      }
    );
  });
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê³µí†µ ì»´í¬ë„ŒíŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ë¦¬ë·° í‰ê·  ë³„ì  ê³„ì‚°
const calculateAverage = (reviews) => {
  if (!reviews.length) return 0;
  return reviews.reduce((sum, review) => sum + review.rating, 0) / reviews.length;
};

// ì¹´ì¹´ì˜¤ë§µ ì¹´í…Œê³ ë¦¬ì—ì„œ ìƒìœ„ ì¹´í…Œê³ ë¦¬ ì œê±°
const extractCategory = (categoryString) => {
  if (!categoryString) return "";
  const parts = categoryString.split(" > ");
  return parts.length > 1 ? parts.slice(1).join(" > ") : parts[0];
};

// ê³µí†µ SVG path
const STAR_PATH = "M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z";
const PIN_PATH = "M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z";
const CHEVRON_LEFT_PATH = "M15 18l-6-6 6-6";
const CHEVRON_RIGHT_PATH = "M9 18l6-6-6-6";
const PHONE_PATH = "M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z";
const CHAT_PATH = "M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z";
const PLUS_PATH = "M12 5v14M5 12h14";
const CLOSE_PATH = "M18 6L6 18M6 6l12 12";
const SEARCH_CIRCLE = {cx: "11", cy: "11", r: "8"};
const SEARCH_LINE = "m21 21-4.35-4.35";

// ë³„ì  í‘œì‹œ ì»´í¬ë„ŒíŠ¸ (ì½ê¸° ì „ìš©)
const Stars = ({rating, size = 18}) => {
  const fullStars = Math.floor(rating);
  const hasHalf = rating - fullStars >= 0.25 && rating - fullStars < 0.75;
  const emptyStars = 5 - fullStars - (hasHalf ? 1 : 0);

  const StarSvg = ({fill, svgKey, children}) => (
    React.createElement("svg", {key: svgKey, width: size, height: size, viewBox: "0 0 24 24", fill, stroke: "none"},
      children || React.createElement("path", {d: STAR_PATH})
    )
  );

  return React.createElement("span", {style: {display: "inline-flex", gap: 2, alignItems: "center"}}, [
    ...Array(fullStars).fill(0).map((_, i) =>
      StarSvg({fill: "var(--brand)", svgKey: "f" + i})
    ),
    hasHalf && React.createElement("svg", {key: "h", width: size, height: size, viewBox: "0 0 24 24"},
      React.createElement("defs", null,
        React.createElement("linearGradient", {id: "hs"},
          React.createElement("stop", {offset: "50%", stopColor: "var(--brand)"}),
          React.createElement("stop", {offset: "50%", stopColor: "var(--neutral-300)"})
        )
      ),
      React.createElement("path", {d: STAR_PATH, fill: "url(#hs)"})
    ),
    ...Array(emptyStars).fill(0).map((_, i) =>
      StarSvg({fill: "var(--neutral-300)", svgKey: "e" + i})
    ),
  ].filter(Boolean));
};

// ë³„ì  ì…ë ¥ ì»´í¬ë„ŒíŠ¸
const StarInput = ({value, onChange}) => (
  <div style={{display: "flex", gap: 6, cursor: "pointer"}}>
    {[1, 2, 3, 4, 5].map(score => (
      <svg
        key={score}
        width={28}
        height={28}
        viewBox="0 0 24 24"
        fill={score <= value ? "var(--brand)" : "var(--neutral-300)"}
        stroke="none"
        onClick={() => onChange(score)}
        style={{transition: "transform .15s, fill .2s", cursor: "pointer"}}
        onMouseEnter={e => e.currentTarget.style.transform = "scale(1.2)"}
        onMouseLeave={e => e.currentTarget.style.transform = "scale(1)"}
      >
        <path d={STAR_PATH}/>
      </svg>
    ))}
  </div>
);

// ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸
const Pin = ({size = 16, color = "currentColor"}) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill={color}>
    <path d={PIN_PATH}/>
  </svg>
);

const SunIcon = () => (
  <svg width={16} height={16} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} strokeLinecap="round">
    <circle cx="12" cy="12" r="5"/>
    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
  </svg>
);

const MoonIcon = () => (
  <svg width={16} height={16} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} strokeLinecap="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
  </svg>
);

// ë’¤ë¡œê°€ê¸° ë²„íŠ¼
const BackButton = ({onClick}) => (
  <button
    className="btn-secondary"
    style={{padding: "8px 18px", fontSize: 13, display: "inline-flex", alignItems: "center", gap: 6}}
    onClick={onClick}
  >
    <svg width={16} height={16} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} strokeLinecap="round" strokeLinejoin="round">
      <path d={CHEVRON_LEFT_PATH}/>
    </svg>
    ëª©ë¡ìœ¼ë¡œ
  </button>
);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ê³µí†µ ìŠ¤íƒ€ì¼ ìƒìˆ˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CARD_STYLE = {
  background: "var(--surface)",
  borderRadius: "var(--radius-xl)",
  padding: "var(--space-xl)",
  boxShadow: "var(--shadow-md)",
  border: "1px solid var(--neutral-200)"
};

const SECTION_STYLE = {
  ...CARD_STYLE,
  boxShadow: "var(--shadow-sm)",
  marginBottom: "var(--space-xl)"
};

const LABEL_STYLE = {
  display: "block",
  fontSize: 13,
  fontWeight: 600,
  color: "var(--neutral-600)",
  marginBottom: 6
};

const CATEGORY_TAG_STYLE = {
  fontSize: 12,
  color: "var(--brand)",
  fontWeight: 600,
  background: "var(--brand-bg)",
  borderRadius: 100,
  display: "inline-block"
};

const DELETE_BTN_STYLE = {
  color: "var(--del-c)",
  borderColor: "var(--del-bc)",
  background: "var(--del-bg)"
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// í•´ì‹œ ë¼ìš°íŒ… ìœ í‹¸ë¦¬í‹°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// URL í•´ì‹œì—ì„œ í˜„ì¬ ê²½ë¡œ íŒŒì‹± (ì˜ˆ: #/detail/123 â†’ {view: "detail", id: "123"})
function parseHash() {
  const hash = window.location.hash.replace("#/", "") || "";
  if (hash.startsWith("detail/")) {
    const id = hash.replace("detail/", "");
    return {view: "detail", id: id ? Number(id) : null};
  }
  if (hash === "add") {
    return {view: "add", id: null};
  }
  return {view: "list", id: null};
}

// ë·° ìƒíƒœì— ë§ëŠ” í•´ì‹œ ìƒì„±
function buildHash(view, id) {
  if (view === "detail" && id) return "#/detail/" + id;
  if (view === "add") return "#/add";
  return "#/";
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Main App
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function App(){
  // ë°ì´í„° ìƒíƒœ
  const [restaurants, setRestaurants] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  // ë·° ìƒíƒœ (URL í•´ì‹œì—ì„œ ì´ˆê¸°ê°’ ì½ê¸°)
  const initialRoute = useMemo(() => parseHash(), []);
  const [view, setView] = useState(initialRoute.view);
  const [selectedId, setSelectedId] = useState(initialRoute.id);
  const [isAnimating, setIsAnimating] = useState(false);
  const [mounted, setMounted] = useState(false);

  // ê²€ìƒ‰ ìƒíƒœ
  const [searchQuery, setSearchQuery] = useState("");
  const [searchResults, setSearchResults] = useState([]);
  const [isSearching, setIsSearching] = useState(false);
  const [hasSearched, setHasSearched] = useState(false);
  const [pickedPlace, setPickedPlace] = useState(null);
  const [kakaoReady, setKakaoReady] = useState(false);
  const searchTimer = useRef(null);
  const isNavigating = useRef(false); // navigateToì—ì„œ í•´ì‹œ ë³€ê²½ ì‹œ hashchange ì¤‘ë³µ ë°©ì§€

  // ë¦¬ë·° ì‘ì„± ìƒíƒœ
  const [reviewNickname, setReviewNickname] = useState("");
  const [reviewRating, setReviewRating] = useState(0);
  const [reviewComment, setReviewComment] = useState("");

  // í…Œë§ˆ ìƒíƒœ
  const [theme, setTheme] = useState(() => {
    try {
      return localStorage.getItem("matjip-theme") || "dark";
    } catch {
      return "dark";
    }
  });

  const selectedRestaurant = restaurants.find(r => r.id === selectedId);

  // í…Œë§ˆ í† ê¸€ í•¨ìˆ˜
  const toggleTheme = useCallback(() => {
    const newTheme = theme === "dark" ? "light" : "dark";
    setTheme(newTheme);
    document.documentElement.setAttribute("data-theme", newTheme);
    try {
      localStorage.setItem("matjip-theme", newTheme);
    } catch (e) {
      console.error("Failed to save theme:", e);
    }
  }, [theme]);

  // ì´ˆê¸° í…Œë§ˆ ì ìš©
  useEffect(() => {
    document.documentElement.setAttribute("data-theme", theme);
  }, []);

  // ì¹´ì¹´ì˜¤ ì§€ë„ SDK ë¡œë“œ
  useEffect(() => {
    if (!USE_KAKAO) return;
    const script = document.createElement("script");
    script.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${KAKAO_JS_KEY}&libraries=services&autoload=false`;
    script.onload = () => {
      window.kakao.maps.load(() => setKakaoReady(true));
    };
    document.head.appendChild(script);
  }, []);

  // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
  useEffect(() => {
    (async () => {
      try {
        const data = await loadFromDB();
        setRestaurants(data);
        setError(null);
      } catch (e) {
        console.error("DB load error:", e);
        setError("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.");
        setRestaurants([]);
      } finally {
        setLoading(false);
        setTimeout(() => setMounted(true), 100);
      }
    })();
  }, []);

  // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸° ì²˜ë¦¬
  useEffect(() => {
    const handleHashChange = () => {
      // navigateToì—ì„œ í•´ì‹œë¥¼ ë°”ê¾¼ ê²½ìš° ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
      if (isNavigating.current) {
        isNavigating.current = false;
        return;
      }

      const route = parseHash();
      // ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸°ëŠ” ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ì¦‰ì‹œ ì „í™˜
      setView(route.view);
      setSelectedId(route.id);
      if (route.view === "add") {
        setSearchQuery("");
        setSearchResults([]);
        setHasSearched(false);
        setPickedPlace(null);
      }
      window.scrollTo({top: 0});
    };

    window.addEventListener("hashchange", handleHashChange);
    return () => window.removeEventListener("hashchange", handleHashChange);
  }, []);

  // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ (í•´ì‹œ ë¼ìš°íŒ… ì—°ë™)
  const navigateTo = useCallback((destination, id = null) => {
    setIsAnimating(true);
    setTimeout(() => {
      setView(destination);
      setSelectedId(id);
      setIsAnimating(false);
      if (destination === "add") {
        setSearchQuery("");
        setSearchResults([]);
        setHasSearched(false);
        setPickedPlace(null);
      }
      // URL í•´ì‹œ ì—…ë°ì´íŠ¸ (ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ì— ê¸°ë¡)
      const newHash = buildHash(destination, id);
      if (window.location.hash !== newHash) {
        isNavigating.current = true;
        window.location.hash = newHash;
      }
      window.scrollTo({top: 0, behavior: "smooth"});
    }, 200);
  }, []);

  // ë§›ì§‘ ê²€ìƒ‰
  const handleSearch = useCallback((query) => {
    setSearchQuery(query);
    setPickedPlace(null);

    if (searchTimer.current) {
      clearTimeout(searchTimer.current);
    }

    if (query.trim().length < 2) {
      setSearchResults([]);
      setHasSearched(false);
      return;
    }

    searchTimer.current = setTimeout(async () => {
      setIsSearching(true);
      try {
        const results = await kakaoSearch(query.trim());
        setSearchResults(results);
        setHasSearched(true);
      } catch (e) {
        console.error("Search error:", e);
        setSearchResults([]);
      } finally {
        setIsSearching(false);
      }
    }, 400);
  }, []);

  // ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ë§›ì§‘ ì„ íƒ
  const selectPlace = useCallback((place) => {
    setPickedPlace(place);
    setSearchResults([]);
    setSearchQuery(place.place_name);
  }, []);

  // ë§›ì§‘ ë“±ë¡
  const addPlace = useCallback(async () => {
    if (!pickedPlace) return;

    const newRestaurant = {
      name: pickedPlace.place_name,
      address: pickedPlace.road_address_name || pickedPlace.address_name,
      category: extractCategory(pickedPlace.category_name),
      phone: pickedPlace.phone || "",
      mapLink: pickedPlace.place_url || "https://map.kakao.com"
    };

    try {
      const row = await addRestaurantToDB(newRestaurant);
      setRestaurants(prev => [{id: row.id, ...newRestaurant, reviews: []}, ...prev]);
      navigateTo("list");
    } catch (e) {
      console.error("Failed to add restaurant:", e);
      alert("ë§›ì§‘ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }
  }, [pickedPlace, navigateTo]);

  // ë¦¬ë·° ë“±ë¡
  const addReview = useCallback(async () => {
    if (!reviewNickname.trim() || !reviewRating || !reviewComment.trim()) return;

    const newReview = {
      nickname: reviewNickname.trim(),
      rating: reviewRating,
      comment: reviewComment.trim()
    };

    try {
      const row = await addReviewToDB(selectedId, newReview);
      setRestaurants(prev => prev.map(r =>
        r.id === selectedId
          ? {...r, reviews: [{id: row.id, ...newReview, createdAt: row.created_at.slice(0, 10)}, ...r.reviews]}
          : r
      ));
      setReviewNickname("");
      setReviewRating(0);
      setReviewComment("");
    } catch (e) {
      console.error("Failed to add review:", e);
      alert("ë¦¬ë·° ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }
  }, [reviewNickname, reviewRating, reviewComment, selectedId]);

  // ë¦¬ë·° ì‚­ì œ
  const deleteReview = useCallback(async (reviewId) => {
    if (!window.confirm("ì´ ë¦¬ë·°ë¥¼ ì‚­ì œí• ê¹Œìš”?")) return;

    try {
      await deleteReviewFromDB(reviewId);
      setRestaurants(prev => prev.map(r =>
        r.id === selectedId
          ? {...r, reviews: r.reviews.filter(rv => rv.id !== reviewId)}
          : r
      ));
    } catch (e) {
      console.error("Failed to delete review:", e);
      alert("ë¦¬ë·° ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }
  }, [selectedId]);

  // ë§›ì§‘ ì‚­ì œ
  const deleteRestaurant = useCallback(async () => {
    if (!selectedId || !window.confirm("ì´ ë§›ì§‘ê³¼ ë¦¬ë·°ë¥¼ ëª¨ë‘ ì‚­ì œí• ê¹Œìš”?")) return;

    try {
      await deleteRestaurantFromDB(selectedId);
      setRestaurants(prev => prev.filter(r => r.id !== selectedId));
      navigateTo("list");
    } catch (e) {
      console.error("Failed to delete restaurant:", e);
      alert("ë§›ì§‘ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }
  }, [selectedId, navigateTo]);

  // í‰ì ìˆœìœ¼ë¡œ ì •ë ¬ëœ ë§›ì§‘ ëª©ë¡
  const sortedRestaurants = useMemo(() => {
    return [...restaurants].sort((a, b) => {
      const avgA = calculateAverage(a.reviews);
      const avgB = calculateAverage(b.reviews);
      return avgB !== avgA ? avgB - avgA : b.reviews.length - a.reviews.length;
    });
  }, [restaurants]);

  if (loading) {
    return (
      <div style={{display: "flex", alignItems: "center", justifyContent: "center", minHeight: "100vh", color: "var(--neutral-400)", fontSize: 15}}>
        ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
      </div>
    );
  }

  if (error) {
    return (
      <div style={{display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", minHeight: "100vh", padding: "20px"}}>
        <div style={{fontSize: 48, marginBottom: 16}}>âš ï¸</div>
        <div style={{fontSize: 18, fontWeight: 600, color: "var(--neutral-800)", marginBottom: 8}}>{error}</div>
        <button className="btn-primary" onClick={() => window.location.reload()} style={{marginTop: 16}}>
          ìƒˆë¡œê³ ì¹¨
        </button>
      </div>
    );
  }

  return(
    <div style={{minHeight:"100vh",background:"var(--bg)",transition:"background .3s"}}>

      {/* â•â•â• Header â•â•â• */}
      <header style={{position:"sticky",top:0,zIndex:50,background:"var(--header-bg)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderBottom:"1px solid var(--neutral-200)",transition:"background .3s,border-color .3s"}}>
        <div className="container-main" style={{maxWidth:960,margin:"0 auto",padding:"0 32px",height:64,display:"flex",alignItems:"center",justifyContent:"space-between"}}>
          <div style={{fontWeight:800,fontSize:22,color:"var(--neutral-900)",cursor:"pointer"}} onClick={()=>navigateTo("list")}>ë§›ì§‘<span style={{color:"var(--brand)"}}>ê¸°ë¡</span></div>
          <div style={{display:"flex",alignItems:"center",gap:8}}>
            <button className="theme-btn" onClick={toggleTheme} aria-label="í…Œë§ˆ ì „í™˜">{theme==="dark"?<SunIcon/>:<MoonIcon/>}</button>
            <div style={{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 10px",borderRadius:100,fontSize:11,fontWeight:600,background:"var(--badge-bg)",color:"var(--badge-color)"}}>
              <div style={{width:6,height:6,borderRadius:"50%",background:"var(--badge-color)"}}/>DB ì—°ê²°ë¨
            </div>
            <button className="btn-primary" style={{padding:"10px 22px",fontSize:14}} onClick={()=>navigateTo("add")}>+ ë§›ì§‘ ë“±ë¡</button>
          </div>
        </div>
      </header>

      <main className={`container-main ${isAnimating ? "page-exit" : "page-enter"}`} style={{maxWidth:960,margin:"0 auto",padding:"0 32px",paddingBottom:120}}>

        {/* â•â•â• LIST â•â•â• */}
        {view==="list"&&<div>
          <div style={{padding:"var(--space-2xl) 0 var(--space-xl)",opacity:mounted?1:0,transform:mounted?"translateY(0)":"translateY(20px)",transition:"all .6s cubic-bezier(.22,1,.36,1)"}}>
            <h1 className="hero-title" style={{fontSize:38,fontWeight:800,color:"var(--neutral-900)",lineHeight:1.25,marginBottom:12}}>ë‚˜ë§Œì˜ ë§›ì§‘ì„<br/><span style={{color:"var(--brand)"}}>ê¸°ë¡</span>í•˜ê³  <span style={{color:"var(--brand)"}}>ê³µìœ </span>í•˜ì„¸ìš”</h1>
            <p style={{fontSize:16,color:"var(--neutral-500)",letterSpacing:"-.02em",lineHeight:1.6}}>ì¹´ì¹´ì˜¤ë§µì—ì„œ ê²€ìƒ‰í•´ì„œ ë§›ì§‘ì„ ë“±ë¡í•˜ê³ , ë³„ì ê³¼ í•œì¤„í‰ì„ ë‚¨ê²¨ë³´ì„¸ìš”</p>
          </div>
          <div style={{display:"flex",gap:12,marginBottom:"var(--space-lg)",flexWrap:"wrap"}}>
            <div className="tag" style={{background:"var(--brand-bg)",color:"var(--brand)"}}><Pin size={14}/>{restaurants.length}ê°œ ë§›ì§‘</div>
            <div className="tag" style={{background:"var(--neutral-100)",color:"var(--neutral-600)"}}><svg width={14} height={14} viewBox="0 0 24 24" fill="currentColor"><path d={CHAT_PATH}/></svg>{restaurants.reduce((s,r)=>s+r.reviews.length,0)}ê°œ ë¦¬ë·°</div>
          </div>

          {restaurants.length===0?
            <div style={{background:"var(--empty-grad)",borderRadius:"var(--radius-xl)",padding:"56px 28px",textAlign:"center",border:"1px solid var(--neutral-200)",boxShadow:"var(--shadow-sm)"}}>
              <div style={{width:84,height:84,margin:"0 auto 18px",borderRadius:"50%",background:"var(--brand-bg)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:38}}>ğŸ½ï¸</div>
              <p style={{fontSize:22,fontWeight:800,color:"var(--neutral-900)",letterSpacing:"-.03em",marginBottom:10}}>ë“±ë¡ëœ ë§›ì§‘ì´ ì•„ì§ ì—†ì–´ìš”</p>
              <p style={{fontSize:14,color:"var(--neutral-500)",lineHeight:1.7,maxWidth:420,margin:"0 auto 24px"}}>ì§€ê¸ˆ ë°”ë¡œ ë§›ì§‘ì„ ë“±ë¡í•´ë³´ì„¸ìš”.</p>
              <button className="btn-primary" onClick={()=>navigateTo("add")}>+ ì²« ë§›ì§‘ ë“±ë¡í•˜ê¸°</button>
            </div>
          :
          <div className="responsive-grid" style={{display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:20}}>
            {sortedRestaurants.map((r, i)=>{const a=calculateAverage(r.reviews);return(
              <div key={r.id} className="card-item stagger-item" style={{animationDelay:`${i*.08}s`,background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"var(--space-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--neutral-200)",display:"flex",flexDirection:"column",gap:14}} onClick={()=>navigateTo("detail", r.id)}>
                <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
                  <div style={{flex:1}}>
                    <h3 style={{fontSize:18,fontWeight:700,color:"var(--neutral-900)",letterSpacing:"-.03em",marginBottom:4}}>{r.name}</h3>
                    {r.category&&<span style={{...CATEGORY_TAG_STYLE, padding: "2px 8px", marginBottom: 4}}>{r.category}</span>}
                    <p style={{fontSize:13,color:"var(--neutral-400)",display:"flex",alignItems:"center",gap:4,marginTop:4}}><Pin size={13} color="var(--neutral-400)"/>{r.address}</p>
                  </div>
                  {a>0&&<div style={{background:a>=4.5?"var(--brand)":a>=3.5?"var(--brand-light)":"var(--neutral-300)",color:a>=3.5?"var(--btn-fg)":"var(--score-low)",borderRadius:"var(--radius-sm)",padding:"6px 10px",fontSize:16,fontWeight:800,minWidth:44,textAlign:"center"}}>{a.toFixed(1)}</div>}
                </div>
                <div style={{display:"flex",alignItems:"center",justifyContent:"space-between"}}>
                  <div style={{display:"flex",alignItems:"center",gap:8}}><Stars rating={a} size={16}/><span style={{fontSize:13,color:"var(--neutral-400)",fontWeight:500}}>ë¦¬ë·° {r.reviews.length}ê°œ</span></div>
                  <svg width={18} height={18} viewBox="0 0 24 24" fill="none" stroke="var(--neutral-300)" strokeWidth={2} strokeLinecap="round" strokeLinejoin="round"><path d={CHEVRON_RIGHT_PATH}/></svg>
                </div>
              </div>
            )})}
          </div>}
        </div>}

        {/* â•â•â• DETAIL â•â•â• */}
        {view==="detail"&&selectedRestaurant&&<div>
          <div style={{padding:"var(--space-lg) 0 var(--space-md)"}}><BackButton onClick={() => navigateTo("list")}/></div>

          <div className="stagger-item" style={{...CARD_STYLE, marginBottom: "var(--space-xl)"}}>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16}}>
              <div style={{flex:1,minWidth:200}}>
                <h1 style={{fontSize:30,fontWeight:800,color:"var(--neutral-900)",lineHeight:1.2,marginBottom:8}}>{selectedRestaurant.name}</h1>
                {selectedRestaurant.category&&<span style={{...CATEGORY_TAG_STYLE, padding: "3px 10px", marginBottom: 10}}>{selectedRestaurant.category}</span>}
                <p style={{fontSize:15,color:"var(--neutral-500)",display:"flex",alignItems:"center",gap:6,marginBottom:8}}><Pin size={16} color="var(--neutral-400)"/>{selectedRestaurant.address}</p>
                {selectedRestaurant.phone&&<p style={{fontSize:14,color:"var(--neutral-500)",display:"flex",alignItems:"center",gap:6,marginBottom:16}}><svg width={15} height={15} viewBox="0 0 24 24" fill="var(--neutral-400)"><path d={PHONE_PATH}/></svg>{selectedRestaurant.phone}</p>}
                <div style={{display:"flex",gap:10,flexWrap:"wrap"}}>
                  <a href={selectedRestaurant.mapLink} target="_blank" rel="noopener noreferrer" style={{display:"inline-flex",alignItems:"center",gap:6,fontSize:14,fontWeight:600,color:"var(--brand)",textDecoration:"none",padding:"8px 16px",borderRadius:"var(--radius-sm)",background:"var(--brand-bg)"}}><Pin size={15} color="var(--brand)"/>ì¹´ì¹´ì˜¤ë§µì—ì„œ ë³´ê¸°</a>
                  <button className="btn-secondary" style={{...DELETE_BTN_STYLE, padding: "8px 14px", fontSize: 13, borderRadius: "var(--radius-sm)"}} onClick={deleteRestaurant}>ë§›ì§‘ ì‚­ì œ</button>
                </div>
              </div>
              <div style={{textAlign:"center",padding:"20px 28px",background:"var(--accent-grad)",borderRadius:"var(--radius-lg)"}}>
                <div style={{fontSize:42,fontWeight:800,color:"var(--brand)",lineHeight:1}}>{selectedRestaurant.reviews.length?calculateAverage(selectedRestaurant.reviews).toFixed(1):"â€”"}</div>
                <Stars rating={calculateAverage(selectedRestaurant.reviews)} size={18}/>
                <div style={{fontSize:13,color:"var(--neutral-500)",marginTop:6,fontWeight:500}}>ë¦¬ë·° {selectedRestaurant.reviews.length}ê°œ</div>
              </div>
            </div>
          </div>

          {/* ë¦¬ë·° ì‘ì„± */}
          <div className="stagger-item" style={{...SECTION_STYLE, animationDelay: ".1s"}}>
            <h2 style={{fontSize:18,fontWeight:700,color:"var(--neutral-900)",letterSpacing:"-.03em",marginBottom:"var(--space-lg)"}}>ë¦¬ë·° ì‘ì„±í•˜ê¸°</h2>
            <div style={{display:"flex",flexDirection:"column",gap:16}}>
              <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
                <div><label style={LABEL_STYLE}>ë‹‰ë„¤ì„</label><input className="input-field" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" value={reviewNickname} onChange={e => setReviewNickname(e.target.value)}/></div>
                <div><label style={LABEL_STYLE}>ë³„ì </label><div style={{paddingTop:8}}><StarInput value={reviewRating} onChange={setReviewRating}/></div></div>
              </div>
              <div><label style={LABEL_STYLE}>í•œì¤„í‰</label><input className="input-field" placeholder="ì´ ë§›ì§‘ì— ëŒ€í•œ í•œì¤„í‰ì„ ë‚¨ê²¨ì£¼ì„¸ìš”" value={reviewComment} onChange={e => setReviewComment(e.target.value)}/></div>
              <div style={{display:"flex",justifyContent:"flex-end"}}><button className="btn-primary" disabled={!reviewNickname.trim() || !reviewRating || !reviewComment.trim()} onClick={addReview}>ë¦¬ë·° ë“±ë¡</button></div>
            </div>
          </div>

          {/* ë¦¬ë·° ëª©ë¡ */}
          <div className="stagger-item" style={{animationDelay:".2s"}}>
            <h2 style={{fontSize:18,fontWeight:700,color:"var(--neutral-900)",letterSpacing:"-.03em",marginBottom:"var(--space-lg)"}}>ë¦¬ë·° {selectedRestaurant.reviews.length}ê°œ</h2>
            {selectedRestaurant.reviews.length===0?
              <div style={{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"var(--space-2xl) var(--space-lg)",textAlign:"center",border:"1px dashed var(--neutral-200)"}}><div style={{fontSize:40,marginBottom:12}}>ğŸ“</div><p style={{fontSize:15,color:"var(--neutral-400)",fontWeight:500}}>ì•„ì§ ë¦¬ë·°ê°€ ì—†ì–´ìš”</p><p style={{fontSize:13,color:"var(--neutral-300)",marginTop:4}}>ì²« ë²ˆì§¸ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”!</p></div>
            :<div style={{display:"flex",flexDirection:"column",gap:12}}>
              {selectedRestaurant.reviews.map((rv,i)=><div key={rv.id} className="review-item" style={{animationDelay:`${i*.06}s`,background:"var(--surface)",borderRadius:"var(--radius-md)",padding:"var(--space-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--neutral-200)"}}>
                <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}>
                  <div style={{display:"flex",alignItems:"center",gap:10}}>
                    <div style={{width:34,height:34,borderRadius:"50%",background:`hsl(${(rv.nickname.charCodeAt(0)*47)%360},50%,var(--av-bg))`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:`hsl(${(rv.nickname.charCodeAt(0)*47)%360},55%,var(--av-fg))`}}>{rv.nickname[0]}</div>
                    <div><div style={{fontSize:14,fontWeight:600,color:"var(--neutral-800)"}}>{rv.nickname}</div><div style={{fontSize:12,color:"var(--neutral-400)"}}>{rv.createdAt}</div></div>
                  </div>
                  <div style={{display:"flex",alignItems:"center",gap:8}}>
                    <Stars rating={rv.rating} size={14}/>
                    <button className="btn-secondary" style={{...DELETE_BTN_STYLE, padding: "6px 10px", fontSize: 12}} onClick={() => deleteReview(rv.id)}>ì‚­ì œ</button>
                  </div>
                </div>
                <p style={{fontSize:15,color:"var(--neutral-700)",lineHeight:1.6,letterSpacing:"-.02em"}}>{rv.comment}</p>
              </div>)}
            </div>}
          </div>
        </div>}

        {/* â•â•â• ADD â•â•â• */}
        {view==="add"&&<div style={{maxWidth:600,margin:"0 auto"}}>
          <div style={{padding:"var(--space-xl) 0 var(--space-lg)"}}><BackButton onClick={() => navigateTo("list")}/></div>

          <div className="stagger-item" style={CARD_STYLE}>
            <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8,flexWrap:"wrap",gap:8}}>
              <h1 style={{fontSize:26,fontWeight:800,color:"var(--neutral-900)"}}>ë§›ì§‘ ê²€ìƒ‰ & ë“±ë¡</h1>
              <div style={{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 10px",borderRadius:100,fontSize:11,fontWeight:600,background:kakaoReady?"var(--badge-bg)":"var(--neutral-100)",color:kakaoReady?"var(--badge-color)":"var(--neutral-500)"}}>
                <div style={{width:6,height:6,borderRadius:"50%",background:kakaoReady?"var(--badge-color)":"var(--neutral-400)"}}/>
                {kakaoReady?"ì¹´ì¹´ì˜¤ ê²€ìƒ‰ ì—°ë™ë¨":USE_KAKAO?"ì¹´ì¹´ì˜¤ ë¡œë”©ì¤‘...":"ì¹´ì¹´ì˜¤ ë¯¸ì—°ê²°"}
              </div>
            </div>
            <p style={{fontSize:14,color:"var(--neutral-400)",marginBottom:"var(--space-xl)",letterSpacing:"-.02em"}}>ê°€ê²Œ ì´ë¦„ì´ë‚˜ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ë©´ ì¹´ì¹´ì˜¤ë§µì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤</p>

            <div style={{position:"relative",marginBottom: pickedPlace ? 20 : 0}}>
              <div style={{position:"relative"}}>
                <div style={{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",color:"var(--neutral-400)",zIndex:1}}>
                  <svg width={18} height={18} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} strokeLinecap="round" strokeLinejoin="round"><circle {...SEARCH_CIRCLE}/><path d={SEARCH_LINE}/></svg>
                </div>
                <input className="input-field" style={{paddingLeft:44,fontSize:16}} placeholder={kakaoReady?"ë§›ì§‘ ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš” (ì˜ˆ: ê°•ë‚¨ ë§›ì§‘, í™ëŒ€ íŒŒìŠ¤íƒ€)":"ì¹´ì¹´ì˜¤ API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”"} value={searchQuery} onChange={e => handleSearch(e.target.value)} disabled={!kakaoReady}/>
                {isSearching &&<div style={{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"}}><div style={{width:18,height:18,border:"2px solid var(--neutral-300)",borderTopColor:"var(--brand)",borderRadius:"50%",animation:"spin .6s linear infinite"}}/></div>}
              </div>

              {searchResults.length > 0 && !pickedPlace &&<div style={{position:"absolute",top:"100%",left:0,right:0,zIndex:20,background:"var(--popover)",borderRadius:"0 0 var(--radius-md) var(--radius-md)",boxShadow:"var(--shadow-lg)",border:"1px solid var(--neutral-200)",borderTop:"none",maxHeight:360,overflowY:"auto"}}>
                {searchResults.map((p, i)=><div key={i} className="search-item" onClick={() => selectPlace(p)}>
                  <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12}}>
                    <div style={{flex:1}}>
                      <div style={{fontSize:15,fontWeight:600,color:"var(--neutral-800)",letterSpacing:"-.02em",marginBottom:4}}>{p.place_name}</div>
                      <div style={{fontSize:13,color:"var(--neutral-500)",marginBottom:2}}>{p.road_address_name||p.address_name}</div>
                      {p.category_name&&<span style={{fontSize:11,color:"var(--brand)",fontWeight:500}}>{extractCategory(p.category_name)}</span>}
                    </div>
                    <div style={{flexShrink:0,width:28,height:28,borderRadius:"50%",border:"1.5px solid var(--neutral-200)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--neutral-400)"}}>
                      <svg width={14} height={14} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2.5} strokeLinecap="round" strokeLinejoin="round"><path d={PLUS_PATH}/></svg>
                    </div>
                  </div>
                </div>)}
              </div>}

              {hasSearched && searchResults.length===0&&searchQuery.trim().length>=2&&!pickedPlace &&!isSearching &&
                <div style={{position:"absolute",top:"100%",left:0,right:0,zIndex:20,background:"var(--popover)",borderRadius:"0 0 var(--radius-md) var(--radius-md)",boxShadow:"var(--shadow-lg)",border:"1px solid var(--neutral-200)",borderTop:"none",padding:"24px 20px",textAlign:"center"}}>
                  <p style={{fontSize:14,color:"var(--neutral-400)"}}>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”</p><p style={{fontSize:13,color:"var(--neutral-300)",marginTop:4}}>ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
                </div>}
            </div>

            {pickedPlace &&<div style={{background:"var(--accent-grad)",border:`1.5px solid var(--pick-bc)`,borderRadius:"var(--radius-lg)",padding:"20px 24px",animation:"fadeUp .3s ease forwards",marginBottom:20}}>
              <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12}}>
                <div style={{flex:1}}>
                  <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:8}}><Pin size={20} color="var(--brand)"/><span style={{fontSize:18,fontWeight:700,color:"var(--neutral-900)",letterSpacing:"-.03em"}}>{pickedPlace.place_name}</span></div>
                  <div style={{display:"flex",flexDirection:"column",gap:4,marginLeft:28}}>
                    <span style={{fontSize:14,color:"var(--neutral-600)"}}>{pickedPlace.road_address_name||pickedPlace.address_name}</span>
                    {pickedPlace.category_name&&<span style={{fontSize:13,color:"var(--brand)",fontWeight:500}}>{extractCategory(pickedPlace.category_name)}</span>}
                    {pickedPlace.phone&&<span style={{fontSize:13,color:"var(--neutral-500)"}}>ğŸ“ {pickedPlace.phone}</span>}
                  </div>
                  {pickedPlace.place_url&&<a href={pickedPlace.place_url} target="_blank" rel="noopener noreferrer" style={{display:"inline-block",marginLeft:28,marginTop:10,fontSize:13,color:"var(--brand-dark)",textDecoration:"none",fontWeight:500}}>ì¹´ì¹´ì˜¤ë§µì—ì„œ í™•ì¸ â†’</a>}
                </div>
                <button onClick={()=>{setPickedPlace(null); setSearchQuery("")}} style={{background:"none",border:"none",cursor:"pointer",padding:4,color:"var(--neutral-400)"}}><svg width={20} height={20} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2} strokeLinecap="round" strokeLinejoin="round"><path d={CLOSE_PATH}/></svg></button>
              </div>
            </div>}

            {pickedPlace &&<div style={{display:"flex",gap:12,justifyContent:"flex-end"}}>
              <button className="btn-secondary" onClick={()=>{setPickedPlace(null); setSearchQuery("")}}>ë‹¤ì‹œ ê²€ìƒ‰</button>
              <button className="btn-primary" onClick={addPlace}>ì´ ë§›ì§‘ ë“±ë¡í•˜ê¸°</button>
            </div>}

            {!pickedPlace &&!hasSearched && searchQuery.length===0&&kakaoReady&&<div style={{marginTop:32,padding:"28px 24px",background:"var(--neutral-50)",borderRadius:"var(--radius-lg)",textAlign:"center"}}>
              <div style={{fontSize:36,marginBottom:12}}>ğŸ”</div>
              <p style={{fontSize:15,color:"var(--neutral-500)",fontWeight:500,marginBottom:6}}>ê°€ê²Œ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
              <p style={{fontSize:13,color:"var(--neutral-400)",lineHeight:1.6}}>ì¹´ì¹´ì˜¤ë§µì—ì„œ ì£¼ì†Œ, ì¹´í…Œê³ ë¦¬, ì „í™”ë²ˆí˜¸ë¥¼<br/>ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤</p>
            </div>}

            {!USE_KAKAO&&<div style={{marginTop:32,padding:"28px 24px",background:"var(--neutral-50)",borderRadius:"var(--radius-lg)",textAlign:"center"}}>
              <div style={{fontSize:36,marginBottom:12}}>âš™ï¸</div>
              <p style={{fontSize:15,color:"var(--neutral-500)",fontWeight:500,marginBottom:6}}>ì¹´ì¹´ì˜¤ API ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
              <p style={{fontSize:13,color:"var(--neutral-400)",lineHeight:1.6}}>index.html ìƒë‹¨ì˜ KAKAO_JS_KEYì—<br/>ì¹´ì¹´ì˜¤ JavaScript í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
            </div>}
          </div>
        </div>}
      </main>

      <footer style={{textAlign:"center",padding:"var(--space-xl) var(--space-lg)",borderTop:"1px solid var(--neutral-200)",fontSize:13,color:"var(--neutral-400)",transition:"border-color .3s,color .3s"}}>ë§›ì§‘ê¸°ë¡ â€” ë‚˜ë§Œì˜ ë§›ì§‘ ë¦¬ë·° ì„œë¹„ìŠ¤</footer>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
